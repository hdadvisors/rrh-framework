# Henrico County {#part-4-3}

This chapter is a summary of the major changes to the Henrico County's population and housing market in the past five years.

```{r}
#| label: setup

library(tidyverse)
library(sf)
library(sp)
library(plotly)
library(simplevis)
library(tidytext)
library(scales)
library(readxl)
library(zoo)
library(lubridate)
library(janitor)
library(viridis)
library(kableExtra)
library(ggiraph)
library(hdatools)
library(ggtext)

years <- 2016:2020
fips <- 51087
name <- "Henrico County"
costar_name <- "Henrico County"

```

## Takeaways

- Henrico County continues to grow --- largely due to international migration and natural increase (+767 between 2020 and 2021), but the county have consistently seen population loss due to domestic out-migration (-1,552 during that same time period). 
- In recent years, renter households with children have been in decline in the county (-1,010). 
- Median home prices in the county have surpassed the \$300,000 mark as of June 2022 --- continuing to leave median renter households further unable to reach homeownership.
- In 2020, there was an over \$12,000 difference in the income needed to afford the median home price and the typical renter income. 
- There continue to be stark differences between rental markets in Eastern and Western Henrico --- with Western Henrico commanding rents several hundred dollars higher.
- In 2018, there still remained a rental shortage of over 12,000 for households making less than 80 percent AMI.


## Demographic and socioeconomic changes

### Population changes

From 2010 to 2020, Henrico County has grown by 9 percent --- an increase of 27,454 residents. The increase has been greater than Chesterfield County (8 percent), but slightly less than the City (11 percent). 

```{r}
#| label: fig-pop
#| fig-cap: !expr "paste0(name, \": Total Population\")"


pop <- read_rds("data/rr_pop_data.rds") |> 
  mutate(GEOID = parse_number(GEOID)) |> 
  filter(counttype != "Forecast",
         GEOID == fips)

pop_bar <- ggplot(pop,
                      aes(x = year,
                          y = value,
                          fill = value,
                          data_id = value,
                          tooltip = label_comma()(value))) +
  geom_col() +
  geom_col_interactive(size = 2) +
  scale_fill_gradientn(colours = c("#CAE3C2", "#74BA91", "#519B8D", "#2B4258")) +
  theme_pha() +
  labs(title = paste0(name, ": Total population"),
       subtitle = "2010 to 2020",
       caption = "**Source:** U.S. Census Bureau Decennial Census and American Community Survey.") +
  scale_y_continuous(labels = label_comma()) +
  theme(axis.title = element_blank(),
        legend.position = "none",
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05)) +
  theme(plot.title.position = "plot",
        plot.caption.position = "plot")  +
  add_zero_line("y")

if (knitr::is_html_output()) {
  
  girafe(ggobj = pop_bar,
         height_svg = 4)
} else {
  
  pop_bar
}

```
Population increases in recent years have largely been the result of international migration and natural increases. But declines in the county have consistently been the result of residents moving elsewhere in the country. Domestic out-migration had been declining in the latter half of the 2010s, but between 2020 and 2021, 1,552 Henrico County residents moved elsewhere.

```{r}
#| label: fig-comp
#| fig-cap: !expr "paste0(name, \": Components of population change\")"

change <- read_rds("data/rr_comp_change.rds") |> 
  filter(year %in% as.character(years) | year == "2021") |> 
  filter(NAMELSAD == name)

pop_change <- ggplot(change,
       aes(x = year,
           y = value,
           fill = component,
           data_id = value,
           tooltip = value)) +
  geom_col() +
  geom_col_interactive(size = 2) +
  facet_wrap(~component) +
  theme_pha() +
  scale_fill_pha() +
  labs(title = paste0(name,": Components of population change"), 
       subtitle = "2016 to 2021",
       caption = "**Note:** 2020 components of change data not available.<br>**Source:** U.S. Census Bureau, Population Estimates Program.")  +
  scale_y_continuous(labels = label_number(big.mark = ",", style_positive = "plus", style_negative = "minus"))  +
  add_zero_line("y")


if (knitr::is_html_output()) {
  
  girafe(ggobj = pop_change,
         height_svg = 4)
  
} else {
  
  pop_change
  
  }

```

### Household characteristics

Homeowner households of all types are increasing in the county --- especially homeowners without children. Between 2016 and 2020, homeowner households without children saw an increase of 2,061, while homeowner households with children only increased by 1,469. Renter households have seen significantly smaller increases among households without children and nonfamily households (i.e. single adults living alone or with roommates). But Henrico County household decrease between 2016 and 2020 was solely experienced by renter households with children. 

```{r}
#| label: fig-children
#| fig-cap: !expr "paste0(name, \": Change in households with children by tenure\")"


# Add choice of household stat (HHs with children, HHs with seniors, subfamilies, etc)

b25115 <- read_rds("data/b25115_data.rds") |> 
  filter(NAME == name)

ch_plot <- ggplot(b25115,
       aes(x = tenure, 
           y = change, 
           fill = tenure,
           data_id = change,
           tooltip = label_comma()(change))) +
  geom_col(position = "dodge") + 
  geom_col_interactive(position = "dodge", size = 2) +
  theme_pha() + 
  scale_fill_pha() +
  facet_wrap(~children, nrow = 1, scales = "free_x") +
  scale_y_continuous(labels = label_number(style_positive = "plus", big.mark = ",")) +
  labs(title = paste0(name, ": Change in households with children by tenure"),
       subtitle = "2016 to 2020",
       caption = "**Source:** U.S. Census Bureau, American Community Survey, Table B25115.")  +
  add_zero_line("y") 


if (knitr::is_html_output()) {
  
  girafe(ggobj = ch_plot,
         height_svg = 4)
  
} else {
  
  ch_plot
  
  }

```

The Grey Wave continues in Henrico County, where there was a 6,603 increase in the senior population between 2016 and 2020. The majority of this growth was among seniors who were the head of family households (+2,821) and seniors living alone (+2,237).

```{r}
#| label: fig-seniors
#| fig-cap: !expr "paste0(name, \": Change in senior population by living arrangement\")"

b09020 <- read_rds("data/b09020_data.rds") |> 
  filter(NAME == name) |> 
  mutate(family = str_replace(family, "Group quarters", " "),
         family = fct_relevel(family, "Family", "Nonfamily", " "))

snr_plot <- ggplot(b09020,
       aes(y = reorder_within(relationship, change, family),
           x = change,
           fill = family,
           data_id = change,
           tooltip = change)) +
  geom_col(position = "dodge") +
  geom_col_interactive(position = "dodge", size = 2) +
  theme_pha() +
  scale_fill_pha() +
  scale_y_reordered() +
  scale_x_continuous(labels = label_comma()) +
  facet_grid(rows = vars(family), scales = "free_y", space = "free", switch = "y") +
  #scale_y_discrete(labels = function(x) str_wrap(x, width = 10)) +
  labs(title = paste0(name, ": Change in senior population<br>by living arrangement"),
       subtitle="2016 to 2020",
       fill="Tenure",
       caption = "**Source:** U.S. Census Bureau, American Community Survey, Table B09020.")  +
  theme(strip.placement = "outside",
        panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_line(color = "#e2e4e3",
                                          size = 0.05))  +
  add_zero_line("y")

if (knitr::is_html_output()) {
  
  girafe(ggobj = snr_plot,
         height_svg = 4)
  
} else {
  
  snr_plot
  
  }
```

### Income and wages

The disparity between homeowner and renter incomes in the county has continued between 2016 and 2020. As of 2020, the median homeowner household income was nearing \$100,000 at \$93,965. But median renter household income was \$48,081 --- nearly \$46,000 less than homeowners.

During this timeframe, the median homeowner household income increased by 7 percent, while renter income only increased by 3 percent.

```{r}
#| label: fig-income
#| fig-cap: !expr "paste0(name, \": Median houshold income by tenure\")"


b25119_cpi <-read_rds("data/b25119_cpi.rds") |> 
  filter(NAME == name)

inc_plot <- ggplot(b25119_cpi, 
       aes(x = year,
           y = dollars20,
           fill = tenure,
           data_id = dollars20,
           tooltip = dollar_format()(dollars20))) +
  geom_col() +
  geom_col_interactive(size =2) +
  theme_pha() +
  scale_fill_pha() +
  facet_wrap(~tenure) +
  scale_y_continuous(labels = dollar_format(), limits = c(0, NA)) +
  labs(title = paste0(name, ": Median houshold income by tenure"), 
       color = "Tenure",
       subtitle = "2016 to 2020 | Adjusted to 2020 dollars",
       caption = "**Source:** U.S. Census Bureau, American Community Survey, Table B25119.") +
  add_zero_line("y")

if (knitr::is_html_output()) {
  
  girafe(ggobj = inc_plot,
         height_svg = 4)
  
} else {
  
  inc_plot
  
  }

```

### Persons with disabilities

Henrico County has seen a net increase of 665 individuals with independent living difficulties between 2016 and 2020. Most of this growth (+350) has been among the early senior population (65 to 74 year age group), but the 35 to 64 year age range is also seeing major increases as well (+257).

```{r}
#| label: fig-ind-living
#| fig-cap: !expr "paste0(name, \": Net change in individuals with independent living difficulties by age\")"

# Add disability stat (probably independent living difficulty)

b18107 <- read_rds("data/b18107_data.rds") |> 
  filter(NAME == name) |> 
  group_by(age) |> 
  summarise(change = sum(change))

ind_plot <- ggplot(b18107,
       aes(x = age,
           y = change,
           fill = age,
           data_id = change,
           tooltip = change)) +
  geom_col() +
  geom_col_interactive(size = 2) +
  theme_pha() +
  scale_fill_pha() +
  labs(title=paste0(name, ": Net change in individuals with<br>independent living difficulties by age"),
       subtitle="2016 to 2020",
       caption="**Source:** U.S. Census Bureau, American Community Survey, Table B18107.") +
  scale_y_continuous(labels = label_comma())  +
  add_zero_line("y") 

if (knitr::is_html_output()) {
  
  girafe(ggobj = ind_plot,
         height_svg = 4)
  
} else {
  
  ind_plot
  
  }

```

## Housing supply and market changes

### Homeownership

The median home sales price has steadily been trending upward in Henrico County, and reached a high of \$371,867 in July 2022. From January 2017 to September 2022, the median home price in the county increased by 37 percent.^[Median home prices have been adjusted to September 2022 dollars.]

```{r}
#| label: fig-sales
#| fig-cap: !expr "paste0(name, \": Median home sales price\")"

# Median sales price over time

price <- read_csv("data/henrico_med_sales.csv") |> 
  clean_names() |> 
  mutate(geography = name) |> 
  pivot_longer(cols = starts_with("sale"),
    names_to = "label",
    values_to = "med_price",
    values_drop_na = TRUE) |> 
  mutate(year = substr(label, 19,23)) |> 
  select(geography, year, month, med_price)

price$month <- match(price$month, month.abb)

price <- price |> 
  mutate(date = make_date(year, month)) |> 
  mutate(med_price = parse_number(med_price))

cpi <- read_csv("data/CPIAUCSL.csv") |> 
  select(date = DATE, cpi = CPIAUCSL)

price_adj <- price |> 
  left_join(cpi, by = "date") |> 
  mutate(dollars = ((296.761/cpi)*med_price)) |> 
  select(date, med_price, dollars) |> 
  pivot_longer(2:3,
               names_to = "type",
               values_to = "dollars") |> 
  filter(type == "dollars")

sales_plot <- ggplot(price_adj,
       aes(x = date,
           y = dollars,
           color = dollars,
           group = 1)) +
  geom_line(size = 1) +
  geom_point_interactive(
    aes(data_id = dollars,
        tooltip = label_dollar()(dollars)),
    size = 0.5) + 
  theme_pha() +
  scale_color_gradientn(colours = c("#CAE3C2", "#74BA91", "#519B8D", "#2B4258")) +
  scale_y_continuous(labels = label_dollar()) +
  scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
  labs(title = paste0(name, ": Median home sales price"),
       subtitle = "January 2017 to September 2022",
       caption = "**Source:** Central Virginia Regional Multiple Listing Service.") +
  geom_smooth(method = "lm", color = "#Be451c")

if (knitr::is_html_output()) {
  
  girafe(ggobj = sales_plot,
         height_svg = 4)
  
} else {
  
  sales_plot
  
  }


```

### Rental

Based on CoStar multifamily market geographies, Henrico County consists of two distinct rental submarkets: Eastern and Western Henrico County.

As of Q3 2022, the average asking rent for Western Henrico (\$1,327) was \$302 greater than that of Eastern Henrico (\$1,225). Regardless of these differences, both submarkets experienced significant increases in average asking rent since the start of the pandemic. Eastern Henrico had a 27 percent increase, while Western Henrico had a 30 percent increase in average asking rent. 

This major rental increase was no doubt a result of tightening rental market amid pandemic eviction protections, as well as an increasing desire to leave denser urban environments during the height of COVID-19.

```{r}
#| label: fig-rent-submarket
#| fig-cap: !expr "paste0(name, \": Average asking rent by submarket\")"

# Average asking rent over time (by submarket if applicable, maybe by bedroom if no submarkets)

# Disaggregate by Richmond CoStar Submarket

# CoStar Filters: Construction Status - Existing

# Added locality field manually

sub_rent <- read_csv("data/rr_submarket_data.csv") |> 
  clean_names() |> 
  separate(geography, into = c("region", "state", "submarket"), sep = " - ") |> 
  select(period, locality, submarket, "rent" = market_asking_rent_unit, vacancy_rate) |> 
  mutate(rent = parse_number(rent)) |> 
  mutate(period = as.Date(as.yearqtr(period, format = "%Y Q%q"), frac = 1)) |> 
  filter(locality == costar_name)

# Issue with above is that rents are not inflation-adjusted. May need to revisit. I've requested from CoStar to allow for an inflation-adjusted average rent per unit pull, BUT who knows if they can add it. Might consider just having a table with most recent rents.

sub_plot <- ggplot(sub_rent,
       aes(x = period,
           y = rent, 
           color = submarket)) +
  geom_line(size = 1) +
  geom_point_interactive(
    aes(data_id = rent,
        tooltip = label_dollar()(rent)),
    size = 0.5) + 
  theme_pha() +
  scale_color_pha() + 
  labs(title = paste0(name, ": Average asking rent by submarket"),
       subtitle = "2016 Q1 to 2022 Q3 | Not adjusted for inflation",
       color = "Submarket",
       caption = "**Source:** CoStar Group, Inc.") +
  scale_y_continuous(labels = label_dollar()) +
  scale_x_date(date_labels = "%Y", date_breaks = "2 years", limits = as.Date(c("2016-01-01", "2022-09-30"))) +
  theme(legend.position = "top")

if (knitr::is_html_output()) {
  
  girafe(ggobj = sub_plot,
         height_svg = 4)
  
} else {
  
  sub_plot
  
  }
```

### Housing assistance

Over the last two and a half years, more than 1,202 new affordable rental unit subsidies were added in the county. However, another 918 contracts expired (across four properties), leading to a net gain of just 284 dedicated affordable rental units.

```{r}
#| label: tbl-nhpd
#| tbl-cap: !expr "paste0(name, \": Added and removed affordable rental contracts since 2020\")"

nhpd_coded_rr <- read_rds("data/nhpd_coded_rr.rds") |> 
  filter(locality == "Henrico County")

change <- nhpd_coded_rr |>
  mutate(change_type = case_when(
    start_date > '2019-12-31' ~ "Added",
    end_date < '2022-09-01' & end_date > '2019-12-31' ~ "Removed",
    TRUE ~ "No change"))

change_table <- change |>
  group_by(change_type) |>
  summarise(subsidies = n(),
            properties = n_distinct(nhpd_property_id),
            units = sum(assisted_units)) |>
  filter(change_type != "No change") |>
  mutate(across(where(is.numeric), ~ ifelse(change_type == "Removed", (.x * -1), .x))) |>
  adorn_totals(name = "Net change")

change_table |>
  mutate(across(where(is.numeric), ~ comma(.x, digits = 0))) |>
  kable(align = "lrrr",
        col.names = c("", "Subsidies", "Properties affected", "Units included")) |>
  kableExtra::kable_styling(bootstrap_options = c("condensed", "striped")) |>
  kableExtra::row_spec(3, bold = TRUE) |>
  kableExtra::footnote(general = "Sources: National Housing Preservation Database and Virginia Housing.",
                       general_title = "")

```


### Naturally-occurring affordable housing

As defined in this report, there are roughly 8,970 units of naturally-occurring affordable housing in Henrico County. These properties are spread out across 42 different buildings within the county. The majority of these properties are garden-style apartments --- typical among NOAH properties.

NOAH properties built in the 1960s command slightly higher rents than those built in later decades. These 1960s NOAH properties are largely located in the highly desirable Tuckahoe area of Western Henrico. Pre-1960s NOAH properties are few and only account for three out of the 42 properties.

```{r}
#| label: fig-noah
#| fig-cap: !expr "paste0(name, \": Distribution of average asking rents in NOAH properties by year built\")"

# Add choice of NOAH stat (total number, change in rent, etc) 

noah <- read_csv("data/pha_noah_81722.csv") |> 
  clean_names() |> 
  st_as_sf(coords = c("longitude", "latitude"), crs=4326, remove=FALSE) |> 
  filter(property_name != "Sedgefield" | property_name != "Holidy Mobile Home Park") |> 
  filter(county_name == "Henrico") |> 
  mutate(period_built = case_when(
    year_built < 1940 ~ "Before 1940",
    year_built %in% 1940:1959 ~ "1940 to 1959",
    year_built %in% 1960:1969 ~ "1960 to 1969",
    year_built > 1969 ~ "1970 or after"
  )) |> 
  mutate(period_built = fct_relevel(period_built, "Before 1940"))
  

noah_plot <- ggplot(noah,
       aes(x = period_built,
           y = avg_asking_unit,
           fill= period_built,
           data_id = avg_asking_unit,
           tooltip = avg_asking_unit)) +
  geom_boxplot(lwd= 0.5, flatten = 1) + 
  geom_boxplot_interactive(lwd= 0.5, flatten = 1, size = 2) +
  theme_pha() +
  scale_fill_pha() +
  scale_y_continuous(labels = label_dollar(), limits = c(800, 1750)) +
  labs(title = paste0(name, ": Distribution of average asking rents<br>in NOAH properties by year built"),
       caption = "**Source:** CoStar Group, Inc.")
  
if (knitr::is_html_output()) {
  
  girafe(ggobj = noah_plot,
         height_svg = 4) 
  
} else {
  
  noah_plot
  
  }

```

## Gap analysis

### Affordability of current housing stock

In 2020, the median renter income estimate required a rent of \$1,202 to be considered affordable (not more than 30 percent of income). At this point in time, the average asking rent was \$1,222 --- only \$20 more. 

The difference between rent affordable to the typical renter and the average rent in the county has been narrowing since 2016 --- when the difference was roughly \$65. 

Although it may seem as Henrico County is becoming more and more affordable to renters, it is increasingly the trend that more and more higher income households are choosing to rent out of necessity or lifestyle preference. As rents continue to rise and wage increases slow, we may soon see that average rents are greater than the median renter household income in Henrico.

```{r}
#| label: fig-income-rent-gap
#| fig-cap: !expr "paste0(name, \": Average asking rent versus rent affordable to median renter income\")"

# Compare local median renter income to average asking rent

b25119_cpi_rent <- b25119_cpi |> 
  filter(tenure == "Renter")

rent <- read_csv("data/rr_annual_rent.csv") |> 
    pivot_longer(cols = 2:8,
               names_to = "locality",
               values_to = "rent_current") |> 
  clean_names() |> 
  filter(locality == costar_name)

rent_gap <- b25119_cpi_rent |> 
  left_join(rent, by = "year") |> 
  mutate(rent_current = parse_number(rent_current)) |> 
  mutate(affordable_rent = (cdollars/12)*.30) |> 
  mutate(difference = rent_current - affordable_rent) |> 
  select(year, rent_current, affordable_rent) |> 
  pivot_longer(2:3,
               names_to = "type",
               values_to = "dollars") |> 
  mutate(type = case_when(
    type == "affordable_rent" ~ "Affordable rent",
    type == "rent_current" ~ "Current rent"
  ))

rentgap <- ggplot(rent_gap,
       aes(x = year,
           y = dollars,
           fill = type,
           data_id = dollars, 
           tooltip = dollar_format()(dollars))) +
  geom_col(position = "dodge") +
  geom_col_interactive(position = "dodge", size =2) +
  theme_pha() +
  scale_fill_pha() +
  scale_y_continuous(labels = label_dollar()) +
  labs(title = "Henrico County: Average asking rent versus<br>rent affordable to median renter income",
       subtitle = "2016 to 2020",
       fill = "Nominal rent",
       caption = "**Sources:** U.S. Census Bureau, American Community Survey, Table B25119<br>and CoStar Group Inc.") +
  theme(legend.position = "top")  +
  add_zero_line("y")

if (knitr::is_html_output()) {
  
  girafe(ggobj = rentgap,
         height_svg = 4)
  
} else {
  
  rentgap
  
  }


```

Attaining homeownership has generally been harder with the median renter incomes. Before 2020, average renter incomes were not enough to afford the median-priced home in the county. As rates dropped in 2020, renters could compete more confidently in the market---but this is likely no longer the case as rates (and prices) have risen significantly.

```{r}
#| label: fig-price-afford
#| fig.cap: !expr "paste0(name, \": Median sales price versus maximum home price affordable to median renter income\")"

costs_income_afford <- read_rds("data/costs_income_afford.rds")

price_afford <- costs_income_afford |> 
  filter(locality == name) |> 
  select(1, 2, 5, 8) |> 
  pivot_longer(cols = 3:4,
               names_to = "type") |> 
  mutate(type = case_when(
    type == "price" ~ "Median sales price",
    TRUE ~ "Maximum affordable home price"
  ))

slgap_plot <- ggplot(price_afford,
       aes(x = year,
           y = value,
           fill = str_wrap(type, 25),
           data_id = value,
           tooltip = dollar_format()(value))) +
  geom_col(position = "dodge") +
  geom_col_interactive(position = "dodge", size = 2) +
  scale_y_continuous(labels = label_dollar()) + 
  theme_pha() +
  scale_fill_pha() +
labs(title = "Henrico County: Income needed to afford median home price<br>versus median renter income",
       subtitle = "2016 to 2020",
       fill = "Nominal income",
       caption = "**Sources:** U.S. Census Bureau, American Community Survey, Table B25119<br>and Central Virginia Regional Multiple Listing Service.") +
  theme(legend.position = "top")  +
  add_zero_line("y")

if (knitr::is_html_output()) {
  
  girafe(ggobj = slgap_plot,
         height_svg = 4) 
  
} else {
  
  slgap_plot
  
  }


```
The shortage of rental housing for households making 80 percent AMI and below has grown between 2015 and 2018 --- from 12,030 in 2015 to 12,184 in 2018. This deficit increase by 154 rental homes was largely among rental housing between 31 to 80 percent AMI. However, below 30 percent AMI rental housing remains the largest need in the county.

```{r}
#| label: fig-gap
#| fig-cap: !expr "paste0(name, \": Rental housing gap by AMI\")"

# Add choice of affordability stat (surplus/deficit, income vs prices, etc)

gap <- read_rds("data/tb_18_match.rds") |> 
  filter(county == name) |> 
  group_by(year, household_income, gapcode) |>
  summarise(estimate = sum(estimate)) |>
  mutate(estimate = case_when(
    gapcode == "Gap" ~ estimate * -1,
    gapcode == "Matches or less than income" ~ estimate
  )) |>
  mutate(gapcode = case_when(
    gapcode == "Gap" ~ "Shortage of units",
    gapcode == "Matches or less than income" ~ "Households at or less than income"
  )) |>
  filter(household_income != "80 percent AMI or greater")

gap_plot <- ggplot(gap,
       aes(x = year, 
           y = estimate,
           fill = str_wrap(gapcode, 25),
           data_id = estimate,
           tooltip = estimate)) +
  geom_col() + 
  geom_col_interactive(size = 2) + 
  facet_grid(~household_income) + 
  theme_pha() +
  scale_fill_pha() + 
  scale_y_continuous(labels = label_comma()) +
  labs(title = paste0(name, ": Rental housing gap by AMI"),
       subtitle = "2015 to 2019",
       caption = "**Source:** U.S. Department of Housing and Urban Development,<br>Comprehensive Housing Affordability Strategy (CHAS), Table 7.") +
  theme(legend.position = "top")  +
  add_zero_line("y")

if (knitr::is_html_output()) {
  
  girafe(ggobj = gap_plot,
         height_svg = 4) 
  
} else {
  
  gap_plot
  
  }

```

### Impact of housing costs

From 2015 to 2019, the number of cost burdened homeowners has been on a steady decline --- an overall decrease of 2,442 cost burdened homeowners. For renters, there has been an overall increase in cost-burdened renters; a net increase of 700 cost-burdened renters since 2015, a significant gain from when the runing difference was only 163 in 2018.

```{r}
#| label: fig-cb
#| fig-cap: !expr "paste0(name, \": Cumulative change in cost-burdened households by tenure\")"

cb <- read_rds("data/cb_7.rds") |> 
  filter(county == name,
         cb_group == "Cost-burdened") |> 
  group_by(year, county, tenure) |> 
  summarise(estimate = sum(estimate)) |> 
  group_by(county, tenure) |> 
  mutate(change = estimate - lag(estimate)) |> 
  drop_na() |> 
  mutate(run_diff = cumsum(change))

cb_diff <- ggplot(cb,
       aes(x = year, 
           y = run_diff, 
           fill = tenure,
           data_id = run_diff,
           tooltip = run_diff)) +
  geom_col(position = "dodge") +
  geom_col_interactive(position = "dodge", size = 2) +
  theme_pha() +
  scale_fill_pha() +
  scale_y_continuous(labels = label_comma()) +
  labs(title = paste0(name, ": Cumulative change in<br>cost-burdened households by tenure"),
       subtitle = "2015 to 2019",
       fill = "Tenure",
       caption = "**Source:** U.S Department of Housing and Urban Development,<br>Comprehensive Housing Affordability Strategy (CHAS), Table 7.") +
  theme(panel.background = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05))  +
  add_zero_line("y") 


if (knitr::is_html_output()) {
  
  girafe(ggobj = cb_diff,
         height_svg = 4) 
  
} else {
  
  cb_diff
  
  }

```
Pre-pandemic eviction filings in Henrico County averaged 933 each month, but since the pandemic eviction filings have dropped to an average of 271 each month. Eviction protections throughout the pandemic led to a 74 percent decrease in the average eviction judgements --- from 361 to 93 per month. 

Compared to other localities in recent months, Henrico County eviction filings and judgements have remained relatively low, but filings in the county have been trending upwards.

```{r}
#| label: fig-evictions
#| fig-cap: !expr "paste0(name, \": Evictions filings and judgements\")"

evictions <- read_csv("data/evictions_17_22.csv") |> 
  pivot_longer(3:142,
               names_to = "data",
               values_to = "value") |> 
  mutate(type = case_when(
    str_detect(data, "Filings") ~ "Filings",
    str_detect(data,"Evictions") ~ "Eviction judgements"
  )) |> 
  mutate(date = str_sub(data, -7, -1)) |> 
  mutate(date = ym(date)) |> 
  mutate(year = year(date)) |> 
  mutate(type = fct_relevel(type, "Filings", "Eviction judgements")) |> 
  filter(Jurisdiction == "Henrico")

eviction_colors <- setNames(c("#f39152", "#be451c"),
                            nm = c("Filings", "Eviction judgements"))

evict_plot <- ggplot(evictions,
       aes(x = date,
           y = value,
           fill = type,
           data_id = value,
           tooltip = value)) +
  geom_col(position = "dodge") +
  geom_col_interactive(position = "dodge", size = 2) +
  theme_pha() +
  scale_x_date(labels = label_date_short(), breaks = breaks_width("6 months")) +
  scale_y_continuous(labels = label_comma()) +
  labs(title = paste0(name, ": Evictions filings and judgements"),
       subtitle = "January 2017 through October 2022",
       caption = "Source: RVA Eviction Lab") +
  scale_fill_manual(values = eviction_colors) +
  theme(legend.position = "bottom",
        legend.title = element_blank(),
        axis.title = element_blank(),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05),
        axis.ticks = element_blank())


if (knitr::is_html_output()) {
  
  girafe(ggobj = evict_plot,
         height_svg = 4) 
  
} else {
  
  evict_plot
  
}

```