# Goochland County {#part-4-6}

This chapter is a summary of the major changes to the Goochland County's population and housing market in the past five years.

```{r setup}

library(tidyverse)
library(tidycensus)
library(sf)
library(sp)
library(plotly)
library(simplevis)
library(tidytext)
library(scales)
library(readxl)
library(zoo)
library(lubridate)
library(janitor)
library(tigris)
library(optiRum)

years <- 2016:2020
fips <- 51075
name <- "Goochland County"
costar_name <- "Goochland County"


```

## Takeaways

- After brief declined in the early 2010s, Goochland County's population has been growing steadily since 2012.
- The majority of population change in the county has been due to domestic migration. Between 2020 and 2021, the county saw 738 new residents from other parts of the region, state, or nation.
- Homeowners have seen increasing median incomes in the county, while renter median renter income gains disappeared by 2020. 
- Despite the COVID-19 pandemic demand, median home price in Goochland County has remained relatively flat, but still among the highest in the region --- averaging in the \$500,00s.
- New rental properties along the eastern border of the county have driven average asking rents well into the $2,000s.
- Cost burden has been in decline for both homeowner and renter households, but nearly one in four renter households in the county remain cost-burdened as of 2018.

## Demographic and socioeconomic changes

### Population changes

Despite an initial decline in the early 2010s, Goochland County's population has been on a steady increase since 2012. From 2012 to 2020, the population has increased by 16 percent to reach 24,727 residents. Much of this growth can be tied to development in the eastern part of the county, where development activity Goochland-Henrico border has been increasing.

```{r}
#| label: fig-pop
#| fig-cap: !expr "paste0(name, \": Total Population\")"

# Add choice of population stat (net change, components, etc)

pop <- read_rds("data/rr_pop_data.rds") |> 
  mutate(GEOID = parse_number(GEOID)) |> 
  filter(counttype != "Forecast",
         GEOID == fips)

pop_bar <- ggplot(pop,
                      aes(x = year,
                          y = value,
                          fill = value)) +
  geom_col() +
  scale_fill_continuous(viridis_pal()) +
  labs(title = paste0(name, ": Total Population"),
       subtitle = "2010 to 2020",
       caption = "Source: U.S. Census Bureau Decennial Census and American Community Survey.") +
  scale_y_continuous(labels = label_comma()) +
  theme(axis.title = element_blank(),
        legend.position = "none",
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05))

# ggplotly(pop_bar) |> 
#   plotly_camera()

pop_bar

```
The growth in population is due in large part to domestic migration. Between 2020 and 2021, 738 new residents arrived in the county from somewhere else in the region, state, or nation. 

```{r}
#| label: fig-comp
#| fig-cap: !expr "paste0(name, \": Components of population change\")"

change <- read_rds("data/rr_comp_change.rds") |> 
  filter(year %in% as.character(years) | year == "2021") |> 
  filter(NAMELSAD == name)

ggplot(change,
       aes(x = year,
           y = value,
           fill = component)) +
  geom_col() +
  facet_wrap(~component) +
  labs(title = paste0(name,": Components of population change"), 
       subtitle = "2016 through 2021",
       fill = "Component of change",
       caption = "Note: 2020 components of change data not available.\nSource: U.S. Census Bureau, Population Estimates Program.") +
  theme(axis.title = element_blank(),
        legend.position = "none",
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05)) +
  scale_y_continuous(labels = label_number(big.mark = ",", style_positive = "plus", style_negative = "minus"))

```

### Household characteristics

All types of households are seeing an increase in the county --- especially homeowner households. Renter households have also seen a net increase in the county between 2016 and 2020, but that growth has mainly been among nonfamily renter households (+119), which typically refers to households that live alone or with a roommate.


```{r}
#| label: fig-children
#| fig-cap: !expr "paste0(name, \": Change in households with children by tenure\")"

# Add choice of household stat (HHs with children, HHs with seniors, subfamilies, etc)

b25115 <- read_rds("data/b25115_data.rds") |> 
  filter(NAME == name)

ggplot(b25115,
       aes(x = children, y = change, fill = tenure)) +
  geom_col(position = "dodge") + 
  facet_wrap(~children, nrow = 1, scales = "free_x") +
  scale_y_continuous(labels = label_number(style_positive = "plus", big.mark = ",")) +
  labs(title = paste0(name, ": Change in households with children by tenure"),
       subtitle = "2016 to 2020",
       fill = "Tenure",
       caption = "Source: U.S. Census Bureau, American Community Survey, Table B25115.") +
  theme(axis.title = element_blank(),
        axis.text.x = element_blank(),
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05),
        axis.ticks = element_blank())

```

The senior population has been growing in the county (+996). Although much of that growth has occurred among seniors living with family, 27 percent of the increase was among seniors living alone.

```{r}
#| label: fig-seniors
#| fig-cap: !expr "paste0(name, \": Change in senior population by living arrangement\")"

b09020 <- read_rds("data/b09020_data.rds") |> 
  filter(NAME == name) |> 
  mutate(family = str_replace(family, "Group quarters", " "),
         family = fct_relevel(family, "Family", "Nonfamily", " "))

ggplot(b09020,
       aes(y = reorder_within(relationship, change, family),
           x = change,
           fill = relationship)) +
  geom_col(position = "dodge") +
  scale_y_reordered() +
  scale_x_continuous(labels = label_comma()) +
  facet_grid(rows = vars(family), scales = "free_y", space = "free", switch = "y") +
  #scale_y_discrete(labels = function(x) str_wrap(x, width = 10)) +
  labs(title = paste0(name, ": Change in senior population by living arrangement"),
       subtitle="2016 to 2020",
       fill="Tenure",
       caption = "Source: U.S. Census Bureau, American Community Survey, Table B09020.") +
  theme(axis.title = element_blank(),
        #axis.text.x = element_blank(),
        panel.background = element_blank(),
        panel.grid.major.y = element_blank(),
        legend.position = "none",
        panel.grid.major.x = element_line(color = "grey95",
                                          size = 0.05),
        axis.ticks = element_blank(),
        strip.placement = "outside",
        strip.text.y = element_text(angle = 0))

```

### Income and wages

Median homeowner household income has been growing in Goochland County. From 2016 to 2020, the typical homeowner household income increased by 14 percent. Renter households saw some initial increases in median household income from 2016 to 2019, but between 2019 and 2020, median renter household income actually decreased by 18 percent (-\$10,291). 

```{r}
#| label: fig-income
#| fig-cap: !expr "paste0(name, \": Median houshold income by tenure\")"

# Add choice of income stat (probably median household income of some kind)

b25119_cpi <-read_rds("data/b25119_cpi.rds") |> 
  filter(NAME == name)

ggplot(b25119_cpi, 
       aes(x = year,
           y = dollars20,
           fill = tenure)) +
  geom_col() +
  facet_wrap(~tenure) +
  scale_y_continuous(labels = dollar_format(), limits = c(0, NA)) +
  labs(title = paste0(name, ": Median houshold income by tenure"), 
       color = "Tenure",
       subtitle = "2016 to 2020 | Adjusted to 2020 dollars",
       caption = "Source: U.S. Census Bureau, American Community Survey") +
  theme(axis.title = element_blank(),
        axis.ticks = element_blank(),
        panel.background = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05),
        legend.position = "none")

```

### Persons with disabilities

Individuals with independent living difficulties have generally been decreasing in the county --- particularly among individuals under 75 years old. But there has been a slight increase in individuals 75 years old and older with independent living difficulties. The net decrease in individuals with independent living difficulties could be a signal of limited accommodations and resources for adults in the county and subsequent departure of those individuals from the county.

```{r}
#| label: fig-ind-living
#| fig-cap: !expr "paste0(name, \": Net change in individuals with independent living difficulties by age\")"

# Add disability stat (probably independent living difficulty)

b18107 <- read_rds("data/b18107_data.rds") |> 
  filter(NAME == name) |> 
  group_by(age) |> 
  summarise(change = sum(change))

ggplot(b18107,
       aes(x = age,
           y = change,
           fill = age)) +
  geom_col() +
  labs(title=paste0(name, ": Net change in individuals with\nindependent living difficulties by age"),
       subtitle="2016 to 2020",
       caption="Source: U.S. Census Bureau, American Community Survey, Table B18107.") +
  scale_y_continuous(labels = label_comma()) +
  theme(axis.title = element_blank(),
        axis.ticks = element_blank(),
        legend.position = "none",
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05))

```

## Housing supply and market changes

### Homeownership

As with all other localities in the region, home prices in the county have followed seasonal trends. In January 2017, the median home price in the county was \$473,901 and by July 2022 reached \$534,441 --- a 13 percent increase. Goochland County saw some spikes in median home price during the pandemic, but clearly those spikes did not exceed previous trends in the county.

```{r}
#| label: fig-sales
#| fig-cap: !expr "paste0(name, \": Median home sales price\")"

# Median sales price over time

price <- read_csv("data/goochland_med_sales.csv") |> 
  clean_names() |> 
  mutate(geography = name) |> 
  pivot_longer(cols = starts_with("sale"),
    names_to = "label",
    values_to = "med_price",
    values_drop_na = TRUE) |> 
  mutate(year = substr(label, 19,23)) |> 
  select(geography, year, month, med_price)

price$month <- match(price$month, month.abb)

price <- price |> 
  mutate(date = make_date(year, month)) |> 
  mutate(med_price = parse_number(med_price))

cpi <- read_csv("data/CPIAUCSL.csv") |> 
  select(date = DATE, cpi = CPIAUCSL)

price_adj <- price |> 
  left_join(cpi, by = "date") |> 
  mutate(dollars = ((295.271/cpi)*med_price)) |> 
  select(date, med_price, dollars) |> 
  pivot_longer(2:3,
               names_to = "type",
               values_to = "dollars") |> 
  filter(type == "dollars")

ggplot(price_adj,
       aes(x = date,
           y = dollars,
           color = dollars)) +
  geom_line(stat = "identity", size = 1) +
  scale_y_continuous(labels = label_dollar(), limits = c(0, NA)) +
  scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
  labs(title = paste0(name, ": Median home sales price (adjusted for inflation)"),
       subtitle = "January 2017 to July 2022",
       caption = "Source: Central Virginia Regional Multiple Listing Service.") +
  theme(axis.title = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        legend.title = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05)) + 
  scale_color_continuous(type = "viridis", label = dollar_format()) +
  geom_smooth(method=lm)

```

### Rental

The rental market in Goochland County has largely grown in the past five years. The development of West Creek Business Park and with it the headquarters for major employers such as CarMax and Capital One has led to increasing demand for housing at the eastern edge of the county. The market has responded with luxury multifamily developments such as The Retreat at West Creek and Tuckahoe Pines and there are at least 1,700 more units on the way.

The increasing rental demand has been apparent in high average asking rent in Goochland County. As of 2022 Q3, average asking rent in the county was \$2,208. Adjusting for inflation shows despite what appears to be a 24 percent increase in rent from 2016 Q1 to 2022 Q3, the value of the dollar has changed in such a way that rent then and now has changed very little. Nonetheless, an average asking rent of \$2,208 remains a steep price for low- and even moderate-income households.

```{r}
#| label: fig-rent
#| fig-cap: !expr "paste0(name, \": Average asking rent\")"

# Pull in Goochland Rent manually

rent <- read_csv("data/goochland_rent.csv") |> 
  clean_names() |> 
  pivot_longer(2:3,
               names_to = "rent",
               values_to = "value") |> 
  mutate(value = parse_number(value)) |> 
  mutate(period = as.Date(as.yearqtr(period, format = "%Y Q%q"), frac = 1)) |> 
  mutate(year = year(period)) |> 
  filter(year >= 2016) |> 
  mutate(rent = case_when(
    rent == "rent" ~ "Nominal rent",
    rent == "rent_adj" ~ "Inflation-adjusted rent"
  ))


ggplot(rent,
       aes(x = period,
           y = value, 
           color = rent)) +
  geom_line(stat = "identity", size = 1) + 
  labs(title = paste0(name, ": Average asking rent by submarket"),
       subtitle = "2016 Q1 to 2022 Q3",
       color = "Dollar value") +
  scale_y_continuous(labels = label_dollar()) +
  scale_x_date(date_labels = "%Y", date_breaks = "2 years", limits = as.Date(c("2016-01-01", "2022-09-30"))) +
  theme(axis.title = element_blank(),
        panel.background = element_blank(),
        axis.ticks = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05))

```

### Housing assistance

As of early 2022, there were no federally-assisted rental housing properties located in Goochland County.

### Naturally-occurring affordable housing

CoStar does not list any one- or two-star rental properties in Goochland County, therefore the number of NOAH properties in the county is largely unknown. However, the U.S. Census Bureau may provide clues as to where NOAH may be generally located in the county by determining what type of structures renters reside in.

As of 2020, the majority of renters reside in single-family homes (71 percent). The share of renters residing single-family homes has decreased as the number of multifamily properties has increased, but there has also been a raw decrease in single-family renters (from 935 in 2016 to 838 in 2020). The large share of single-family rentals could potentially be a large source of NOAH in the county.

```{r}
#| label: fig-ro-structure-percent
#| fig.cap: !expr "paste0(name, \": Change in share of renter-occupied housing units by structure type\")"


b25127_data <- read_rds("data/b25127_data.rds") |> 
  filter(GEOID %in% fips,
         tenure == "Renter") |> 
  ungroup()

ro_structure_percent <- b25127_data |> 
  filter(structure != "Other") |>
  select(5, 6, 10) |> 
  pivot_longer(
    cols = 2:3,
    names_to = "year",
    values_to = "estimate") |> 
  group_by(structure, year) |> 
  summarise(estimate = sum(estimate)) |> 
  group_by(year) |> 
  mutate(pct = estimate/sum(estimate))

ggplot(ro_structure_percent,
       aes(x = structure,
           y = pct,
           fill = year,
           label = label_percent(accuracy = 0.1)(pct))) +
  geom_col(position = "dodge") +
  geom_text(vjust = 1.5,
            color = "white",
            position = position_dodge(width = 0.9)) +
  labs(title = "Change in share of renter-occupied housing units by structure type",
       subtitle = "2016 to 2020",
      caption = "Source: U.S. Census Bureau, American Community Survey, Table B25127.") +
  theme(panel.background = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        legend.title = element_blank()) +
  scale_y_continuous(labels = label_percent())

```

## Gap analysis

### Affordability of current housing stock

When comparing renter income to the average asking rent in a year, Goochland County has seen a persistent gap between what is on the market and what is affordable to the typical renter. The gap between median renter household income and average asking rent in 2016 was \$752. By 2020, that gap had increased by \$10 --- continuing to leave the typical renter hundreds of dollars short of affording the typical rent.

```{r}
#| label: fig-income-rent-gap
#| fig-cap: !expr "paste0(name, \": Average asking rent versus\nrent affordable to median renter income\")"

# Compare local median renter income to average asking rent

b25119_cpi_rent <- b25119_cpi |> 
  filter(tenure == "Renter")

rent <- read_csv("data/rr_annual_rent.csv") |> 
    pivot_longer(cols = 2:8,
               names_to = "locality",
               values_to = "rent_current") |> 
  clean_names() |> 
  filter(locality == costar_name)

rent_gap <- b25119_cpi_rent |> 
  left_join(rent, by = "year") |> 
  mutate(rent_current = parse_number(rent_current)) |> 
  mutate(affordable_rent = (cdollars/12)*.30) |> 
  mutate(difference = rent_current - affordable_rent) |> 
  select(year, rent_current, affordable_rent) |> 
  pivot_longer(2:3,
               names_to = "type",
               values_to = "dollars") |> 
  mutate(type = case_when(
    type == "affordable_rent" ~ "Affordable rent",
    type == "rent_current" ~ "Current rent"
  ))

ggplot(rent_gap,
       aes(x = year,
           y = dollars,
           fill = type)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = label_dollar()) +
  labs(title = paste0(name, ": Average asking rent versus\nrent affordable to median renter income"),
       subtitle = "2016 to 2020",
       fill = "Nominal rent",
       caption = "Sources: U.S. Census Bureau, American Community Survey, Table B25119\nand CoStar Group Inc.") +
  theme(axis.title = element_blank(),
        axis.ticks = element_blank(),
        panel.background = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05))


```
.
For renters to afford homeownership, the income needed to afford the the median priced home is a steep economic climb. In 2016, a household needed to make roughly \$87,483 to afford the median sales price, but a renter's median household income was only \$40,915. By 2020, the gap had only narrowed slightly to \$39,448.

```{r}
#| label: fig-income-own-gap
#| fig-cap: !expr "paste0(name, \": Income needed to afford median home price\nversus median renter income\")"

# Compare local renter income versus local home prices

rr_sales_annual <- read_csv("data/rr_annual_sales.csv") |> 
  pivot_longer(cols = 2:9,
               names_to = "locality",
               values_to = "price") |> 
  clean_names() |> 
  filter(locality == costar_name)

int_annual <- read_csv("data/fredmac_int_annual.csv")

downpayment <- 0.05 # 5% downpayment
closingcosts <- 0.015 # 1.5% closing costs
utilities <- 250 # Assume $250/month for utilities

sale <- rr_sales_annual |> 
  left_join(b25119_cpi_rent, by = "year") |> 
  left_join(int_annual, by = "year") |> 
  drop_na() |> 
  mutate(principal = price - (price*downpayment)) |> 
  mutate(loanamt = principal/(1-closingcosts)) |> 
  mutate(mortgage = abs(PMT((annual_int/12), 360, loanamt)) + 250) |> 
  mutate(inc_needed = ((mortgage*10)/2.8)*12) |> 
  select(year, inc_needed, cdollars)

slgap <- sale |> 
  pivot_longer(2:3,
               names_to = "data",
               values_to = "value") |> 
  mutate(data = case_when(
    data == "cdollars" ~ "Renter median household income",
    data == "inc_needed" ~ "Income needed to afford median home price"
  ))

ggplot(slgap,
       aes(x = year,
           y = value,
           fill = str_wrap(data, 25))) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = label_dollar()) +
  labs(title = paste0(name, ": Income needed to afford median home price\nversus median renter income"),
       subtitle = "2016 to 2020",
       fill = "Nominal income",
       caption = "Sources: U.S. Census Bureau, American Community Survey, Table B25119\nand Central Virginia Regional Multiple Listing Service.") +
  theme(axis.title = element_blank(),
        axis.ticks = element_blank(),
        panel.background = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05),
        legend.key.height=unit(1, "cm"))


```
The latest data from HUD shows that there was a shortage of 160 rental homes affordable to households making less than 80 percent AMI in 2018. This was a deficit decrease from 2015 when the shortage was 274. For Goochland County, the shortage among renters below 30 percent AMI has been declining slightly. But the major shortage exists among renters between 31 and 50 percent AMI.

```{r}
#| label: fig-gap
#| fig-cap: !expr "paste0(name, \": Rental housing gap by AMI\")"

# Add choice of affordability stat (surplus/deficit, income vs prices, etc)

gap <- read_rds("data/tb_18_match.rds") |> 
  filter(county == name) |> 
  group_by(year, household_income, gapcode) |>
  summarise(estimate = sum(estimate)) |>
  mutate(estimate = case_when(
    gapcode == "Gap" ~ estimate * -1,
    gapcode == "Matches or less than income" ~ estimate
  )) |>
  mutate(gapcode = case_when(
    gapcode == "Gap" ~ "Shortage of units",
    gapcode == "Matches or less than income" ~ "Households at or less than income"
  )) |>
  filter(household_income != "80 percent AMI or greater")

ggplot(gap,
       aes(x = year, 
           y = estimate,
           fill = gapcode)) +
  geom_bar(stat = "identity") +
  facet_grid(~household_income) +
  scale_y_continuous(labels = label_comma()) +
  labs(title = paste0(name, ": Rental housing gap by AMI"),
       subtitle = "2015 to 2018",
       caption = "Source: U.S. Department of Housing and Urban Development,\nComprehensive Housing Affordability Strategy (CHAS), Table 7.") +
  theme(axis.title = element_blank(),
        axis.ticks = element_blank(),
        panel.background = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05),
        legend.position = "bottom",
        legend.title = element_blank())

```

### Impact of housing costs

Cost burden in the county has declined in the county for both homeowners and renters. In 2015, 22 percent of homeowners were cost-burdened, but by 2018 that estimate had declined to 18 percent. Renters also saw declines --- from roughly 32 percent to 25 percent during this same time period. 

```{r}
#| label: fig-cb
#| fig-cap: !expr "paste0(name, \": Cost-burdened households by tenure\")"

cb <- read_rds("data/cb_7.rds") |> 
  filter(county == name) |> 
  group_by(year, tenure, cb_group) |> 
  summarise(estimate = sum(estimate)) |> 
  mutate(pct = estimate/sum(estimate))

ggplot(cb,
       aes(x = year, y = pct, fill = cb_group)) +
  facet_wrap(~tenure) +
  geom_col(position = position_fill(reverse = TRUE)) +
  scale_y_continuous(labels = percent_format()) +
  labs(title = paste0(name, ": Cumulative change in cost-burdened households by tenure"),
       subtitle = "2015 to 2018",
       fill = "Cost burden",
       caption = "Source: U.S Department of Housing and Urban Development,\nComprehensive Housing Affordability Strategy (CHAS), Table 7.") +
  theme(axis.title = element_blank(),
        axis.ticks = element_blank(),
        panel.background = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05))

```
McKinney-Vento Act data shows small changes in the number of enrolled students experiencing homelessness. Although there was a decline from the 2016-2017 school year, the number of students experiencing homelessness increased in the most recent year of 2019-2020. In rural communities like Goochland County, homelessness can often be invisible and difficult to assess. In some cases, substandard housing is a just as critical issue for those extremely low-income individuals and households.

```{r}
#| label: fig-mkv
#| fig-cap: !expr "paste0(name, \"Enrolled students experiencing homelessness by school year\")"

div <- 37

mkv <- read_csv("data/mkv.csv") |> 
  subset(Division %in% div)

ggplot(mkv,
       aes(x = year,
           y = students,
           fill = Name)) +
  geom_bar(stat = "identity") +
  facet_wrap(~Name) +
  labs(title = "Enrolled students experiencing homelessness by school year",
       subtitle = "2016-2017 to 2019-2020",
       caption = "William & Mary School of Education, Project HOME - Virginia.") +
  theme(axis.title = element_blank(),
        legend.position = "none",
        panel.background = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(color = "grey95",
                                          size = 0.05),
        axis.ticks = element_blank()) +
  scale_y_continuous(labels = label_comma())

```
